<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SyncSlide</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.min.js"></script>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <div class="pdf-viewer">
      <h1>Welcome to SyncSlide</h1>
      <p>Emphasizes synchronized viewing of slides in real-time.</p>
      <div>
        <input type="text" id="groupName" placeholder="Enter group name">
        <input type="text" id="userName" placeholder="Enter your name">
        <button id="createGroup">Create Group</button>
        <button id="joinGroup">Join Group</button>
      </div>

      <div id="groupInfo">
        <h3>Group Info</h3>
        <p>Group Name: <span id="groupTitle"></span></p>
        <p>Admin: <span id="adminName"></span></p>
        <p>Members: <span id="memberCount">0</span></p>
        <ul id="memberList"></ul>
      </div>
    </div>
  </div>

  <script src="/socket.io/socket.io.js"></script>
  <script>
    const socket = io();
    const createGroupBtn = document.getElementById('createGroup');
    const joinGroupBtn = document.getElementById('joinGroup');
    const groupNameInput = document.getElementById('groupName');
    const userNameInput = document.getElementById('userName');
    const groupTitle = document.getElementById('groupTitle');
    const adminName = document.getElementById('adminName');
    const memberCount = document.getElementById('memberCount');
    const memberList = document.getElementById('memberList');

    // Create group
    createGroupBtn.addEventListener('click', () => {
      const groupName = groupNameInput.value;
      const userName = userNameInput.value || "Guest"; // Default name if none provided
      if (groupName) {
        socket.emit('createGroup', { groupName, adminName: userName });
      } else {
        alert('Please enter a group name.');
      }
    });

    // Join group
    joinGroupBtn.addEventListener('click', () => {
      const groupName = groupNameInput.value;
      const userName = userNameInput.value || "Guest"; // Default name if none provided
      if (groupName) {
        socket.emit('joinGroup', { groupName, userName });
      } else {
        alert('Please enter a group name.');
      }
    });

    // Group created successfully
    socket.on('groupCreated', ({ groupName, admin }) => {
      groupTitle.textContent = groupName;
      adminName.textContent = `${admin}`;
      updateGroupInfo();
    });

    // Joined group successfully
    socket.on('joinedGroup', ({ groupName, admin }) => {
      groupTitle.textContent = groupName;
      adminName.textContent = `${admin}`;
      updateGroupInfo();
    });

    // Update group members list
    socket.on('updateGroup', ({ groupName, admin, members }) => {
      groupTitle.textContent = groupName;
      adminName.textContent = `${admin}`;
      memberCount.textContent = members.length;
      memberList.innerHTML = ''; // Clear the member list before updating it
      members.forEach(member => {
        const li = document.createElement('li');
        li.textContent = member.name;
        if (member.id === members[0].id) { // Highlight admin
          li.style.fontWeight = 'bold';
          li.style.color = 'green';
        }
        memberList.appendChild(li);
      });
    });

    // Error handling
    socket.on('error', (message) => {
      alert(message);
    });

    function updateGroupInfo() {
      socket.emit('updateGroup');
    }
  </script>
</body>
</html>
